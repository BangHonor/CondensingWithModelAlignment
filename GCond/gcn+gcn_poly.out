nohup: ignoring input
WARNING:root:The OGB package is out of date. Your version is 1.3.4, while the latest version is 1.3.5.
Namespace(gpu_id=0, dataset='ogbn-arxiv', dis_metric='ours', epochs=500, nlayers=3, hidden=256, lr_adj=0.01, lr_feat=0.01, lr_model=0.01, weight_decay=0.0, dropout=0.5, normalize_features=True, keep_ratio=1.0, reduction_rate=0.005, batch_size=36000, seed=1, outer=2000, inner=2000, alpha=0.05, threshold=0.1, kl_t=2, debug=0, save=1, teacher_model='GCN', model='GCN')
pyg_data: Data(num_nodes=169343, x=[169343, 128], node_year=[169343, 1], y=[169343, 1], adj_t=[169343, 169343, nnz=1166243])
split_index: {'train': tensor([     0,      1,      2,  ..., 169145, 169148, 169251]), 'valid': tensor([   349,    357,    366,  ..., 169185, 169261, 169296]), 'test': tensor([   346,    398,    451,  ..., 169340, 169341, 169342])}
train val test的长度: 90941 29799 48603
size of adj_train: (90941, 90941)
edges in adj_train: 738066.0
Teacher model test set results: accuracy= 0.7146
正式训练小图！
/home/disk3/xzb/anaconda3/envs/gd/lib/python3.9/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Epoch 0 Train set results: loss= 31.4406 accuracy= 0.0782
Epoch 0 Validation set results: accuracy= 0.1464
Epoch 0 Test set results: accuracy= 0.2145
Epoch 50 Train set results: loss= 7.5275 accuracy= 0.1429
Epoch 50 Validation set results: accuracy= 0.1127
Epoch 50 Test set results: accuracy= 0.1044
Epoch 100 Train set results: loss= 3.0991 accuracy= 0.2180
Epoch 100 Validation set results: accuracy= 0.2541
Epoch 100 Test set results: accuracy= 0.2433
Epoch 150 Train set results: loss= 3.1490 accuracy= 0.1296
Epoch 150 Validation set results: accuracy= 0.1451
Epoch 150 Test set results: accuracy= 0.1383
Epoch 200 Train set results: loss= 3.1091 accuracy= 0.1973
Epoch 200 Validation set results: accuracy= 0.2439
Epoch 200 Test set results: accuracy= 0.2327
Epoch 250 Train set results: loss= 3.1019 accuracy= 0.1681
Epoch 250 Validation set results: accuracy= 0.2183
Epoch 250 Test set results: accuracy= 0.2319
Epoch 300 Train set results: loss= 3.2045 accuracy= 0.0980
Epoch 300 Validation set results: accuracy= 0.1095
Epoch 300 Test set results: accuracy= 0.1115
Epoch 350 Train set results: loss= 3.1385 accuracy= 0.1275
Epoch 350 Validation set results: accuracy= 0.0796
Epoch 350 Test set results: accuracy= 0.0689
Epoch 400 Train set results: loss= 3.1042 accuracy= 0.1800
Epoch 400 Validation set results: accuracy= 0.1628
Epoch 400 Test set results: accuracy= 0.1911
Epoch 450 Train set results: loss= 3.0867 accuracy= 0.1716
Epoch 450 Validation set results: accuracy= 0.1553
Epoch 450 Test set results: accuracy= 0.1726
Epoch 500 Train set results: loss= 3.1664 accuracy= 0.1291
Epoch 500 Validation set results: accuracy= 0.0695
Epoch 500 Test set results: accuracy= 0.0510
Epoch 550 Train set results: loss= 3.0464 accuracy= 0.2054
Epoch 550 Validation set results: accuracy= 0.1129
Epoch 550 Test set results: accuracy= 0.0982
Epoch 600 Train set results: loss= 3.1323 accuracy= 0.1692
Epoch 600 Validation set results: accuracy= 0.1740
Epoch 600 Test set results: accuracy= 0.2047
Epoch 650 Train set results: loss= 3.3096 accuracy= 0.0907
Epoch 650 Validation set results: accuracy= 0.0842
Epoch 650 Test set results: accuracy= 0.0924
Epoch 700 Train set results: loss= 3.1774 accuracy= 0.1153
Epoch 700 Validation set results: accuracy= 0.1264
Epoch 700 Test set results: accuracy= 0.1329
Epoch 750 Train set results: loss= 3.3616 accuracy= 0.1541
Epoch 750 Validation set results: accuracy= 0.0802
Epoch 750 Test set results: accuracy= 0.0625
Epoch 800 Train set results: loss= 2.9729 accuracy= 0.2690
Epoch 800 Validation set results: accuracy= 0.2999
Epoch 800 Test set results: accuracy= 0.3147
Epoch 850 Train set results: loss= 3.0058 accuracy= 0.1844
Epoch 850 Validation set results: accuracy= 0.1678
Epoch 850 Test set results: accuracy= 0.1484
Epoch 900 Train set results: loss= 2.8503 accuracy= 0.2916
Epoch 900 Validation set results: accuracy= 0.2427
Epoch 900 Test set results: accuracy= 0.2184
Epoch 950 Train set results: loss= 3.0326 accuracy= 0.2624
Epoch 950 Validation set results: accuracy= 0.2492
Epoch 950 Test set results: accuracy= 0.2587
Epoch 1000 Train set results: loss= 3.0049 accuracy= 0.1958
Epoch 1000 Validation set results: accuracy= 0.1318
Epoch 1000 Test set results: accuracy= 0.1156
Epoch 1050 Train set results: loss= 3.0072 accuracy= 0.1695
Epoch 1050 Validation set results: accuracy= 0.1034
Epoch 1050 Test set results: accuracy= 0.0890
Epoch 1100 Train set results: loss= 2.8957 accuracy= 0.2755
Epoch 1100 Validation set results: accuracy= 0.1855
Epoch 1100 Test set results: accuracy= 0.1578
Epoch 1150 Train set results: loss= 3.1336 accuracy= 0.2588
Epoch 1150 Validation set results: accuracy= 0.2215
Epoch 1150 Test set results: accuracy= 0.1881
Epoch 1200 Train set results: loss= 2.8372 accuracy= 0.2796
Epoch 1200 Validation set results: accuracy= 0.2235
Epoch 1200 Test set results: accuracy= 0.1925
Epoch 1250 Train set results: loss= 2.8528 accuracy= 0.2845
Epoch 1250 Validation set results: accuracy= 0.2218
Epoch 1250 Test set results: accuracy= 0.2076
Epoch 1300 Train set results: loss= 2.7861 accuracy= 0.2534
Epoch 1300 Validation set results: accuracy= 0.2646
Epoch 1300 Test set results: accuracy= 0.2348
Epoch 1350 Train set results: loss= 2.7077 accuracy= 0.2934
Epoch 1350 Validation set results: accuracy= 0.2394
Epoch 1350 Test set results: accuracy= 0.2067
Epoch 1400 Train set results: loss= 2.9174 accuracy= 0.3209
Epoch 1400 Validation set results: accuracy= 0.3296
Epoch 1400 Test set results: accuracy= 0.2936
Epoch 1450 Train set results: loss= 2.5184 accuracy= 0.3403
Epoch 1450 Validation set results: accuracy= 0.3576
Epoch 1450 Test set results: accuracy= 0.3349
Epoch 1500 Train set results: loss= 2.5449 accuracy= 0.3347
Epoch 1500 Validation set results: accuracy= 0.3454
Epoch 1500 Test set results: accuracy= 0.3220
Epoch 1550 Train set results: loss= 2.5508 accuracy= 0.3466
Epoch 1550 Validation set results: accuracy= 0.3564
Epoch 1550 Test set results: accuracy= 0.3313
Epoch 1600 Train set results: loss= 2.5644 accuracy= 0.3274
Epoch 1600 Validation set results: accuracy= 0.3355
Epoch 1600 Test set results: accuracy= 0.3073
Epoch 1650 Train set results: loss= 2.4544 accuracy= 0.3505
Epoch 1650 Validation set results: accuracy= 0.3604
Epoch 1650 Test set results: accuracy= 0.3340
Epoch 1700 Train set results: loss= 2.5566 accuracy= 0.3252
Epoch 1700 Validation set results: accuracy= 0.3383
Epoch 1700 Test set results: accuracy= 0.3117
Epoch 1750 Train set results: loss= 2.4627 accuracy= 0.3443
Epoch 1750 Validation set results: accuracy= 0.3518
Epoch 1750 Test set results: accuracy= 0.3271
Epoch 1800 Train set results: loss= 2.4195 accuracy= 0.3554
Epoch 1800 Validation set results: accuracy= 0.3528
Epoch 1800 Test set results: accuracy= 0.3176
Epoch 1850 Train set results: loss= 2.5932 accuracy= 0.3374
Epoch 1850 Validation set results: accuracy= 0.3639
Epoch 1850 Test set results: accuracy= 0.3351
Epoch 1900 Train set results: loss= 2.4934 accuracy= 0.3466
Epoch 1900 Validation set results: accuracy= 0.3530
Epoch 1900 Test set results: accuracy= 0.3378
Epoch 1950 Train set results: loss= 2.4951 accuracy= 0.3489
Epoch 1950 Validation set results: accuracy= 0.3669
Epoch 1950 Test set results: accuracy= 0.3517
Epoch 2000 Train set results: loss= 2.5871 accuracy= 0.3587
Epoch 2000 Validation set results: accuracy= 0.3963
Epoch 2000 Test set results: accuracy= 0.3691
小图训练用时: 1181 秒
Best Test Acc: tensor(0.3691, device='cuda:0', dtype=torch.float64)
