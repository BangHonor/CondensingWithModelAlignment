nohup: ignoring input
WARNING:root:The OGB package is out of date. Your version is 1.3.4, while the latest version is 1.3.5.
Namespace(gpu_id=0, dataset='ogbn-arxiv', dis_metric='ours', epochs=500, nlayers=3, hidden=256, lr_adj=0.01, lr_feat=0.01, lr_model=0.01, weight_decay=0.0, dropout=0.5, normalize_features=True, keep_ratio=1.0, reduction_rate=0.005, batch_size=36000, seed=1, outer=2000, inner=2000, alpha=0.05, threshold=0.1, kl_t=2, debug=0, save=1, teacher_model='GCN', model='APPNP')
pyg_data: Data(num_nodes=169343, x=[169343, 128], node_year=[169343, 1], y=[169343, 1], adj_t=[169343, 169343, nnz=1166243])
split_index: {'train': tensor([     0,      1,      2,  ..., 169145, 169148, 169251]), 'valid': tensor([   349,    357,    366,  ..., 169185, 169261, 169296]), 'test': tensor([   346,    398,    451,  ..., 169340, 169341, 169342])}
train val test的长度: 90941 29799 48603
size of adj_train: (90941, 90941)
edges in adj_train: 738066.0
Teacher model test set results: accuracy= 0.7146
正式训练小图！
/home/disk3/xzb/anaconda3/envs/gd/lib/python3.9/site-packages/torch/nn/_reduction.py:42: UserWarning: size_average and reduce args will be deprecated, please use reduction='sum' instead.
  warnings.warn(warning.format(ret))
Epoch 0 Train set results: loss= 4.7346 accuracy= 0.0537
Epoch 0 Validation set results: accuracy= 0.0418
Epoch 0 Test set results: accuracy= 0.0304
Epoch 50 Train set results: loss= 2.9696 accuracy= 0.3207
Epoch 50 Validation set results: accuracy= 0.3678
Epoch 50 Test set results: accuracy= 0.3735
Epoch 100 Train set results: loss= 1.8985 accuracy= 0.4689
Epoch 100 Validation set results: accuracy= 0.4630
Epoch 100 Test set results: accuracy= 0.4781
Epoch 150 Train set results: loss= 1.8101 accuracy= 0.5203
Epoch 150 Validation set results: accuracy= 0.5531
Epoch 150 Test set results: accuracy= 0.5619
Epoch 200 Train set results: loss= 1.9897 accuracy= 0.5083
Epoch 200 Validation set results: accuracy= 0.5328
Epoch 200 Test set results: accuracy= 0.5389
Epoch 250 Train set results: loss= 1.9231 accuracy= 0.5255
Epoch 250 Validation set results: accuracy= 0.5144
Epoch 250 Test set results: accuracy= 0.5177
Epoch 300 Train set results: loss= 1.8757 accuracy= 0.5452
Epoch 300 Validation set results: accuracy= 0.5578
Epoch 300 Test set results: accuracy= 0.5593
Epoch 350 Train set results: loss= 1.9428 accuracy= 0.5441
Epoch 350 Validation set results: accuracy= 0.5380
Epoch 350 Test set results: accuracy= 0.5478
Epoch 400 Train set results: loss= 1.9571 accuracy= 0.5377
Epoch 400 Validation set results: accuracy= 0.5142
Epoch 400 Test set results: accuracy= 0.5147
Epoch 450 Train set results: loss= 1.8518 accuracy= 0.5567
Epoch 450 Validation set results: accuracy= 0.5579
Epoch 450 Test set results: accuracy= 0.5597
Epoch 500 Train set results: loss= 1.8917 accuracy= 0.5528
Epoch 500 Validation set results: accuracy= 0.5548
Epoch 500 Test set results: accuracy= 0.5580
Epoch 550 Train set results: loss= 1.8459 accuracy= 0.5572
Epoch 550 Validation set results: accuracy= 0.5594
Epoch 550 Test set results: accuracy= 0.5714
Epoch 600 Train set results: loss= 1.8356 accuracy= 0.5624
Epoch 600 Validation set results: accuracy= 0.5549
Epoch 600 Test set results: accuracy= 0.5574
Epoch 650 Train set results: loss= 1.8209 accuracy= 0.5642
Epoch 650 Validation set results: accuracy= 0.5716
Epoch 650 Test set results: accuracy= 0.5764
Epoch 700 Train set results: loss= 1.8034 accuracy= 0.5654
Epoch 700 Validation set results: accuracy= 0.5696
Epoch 700 Test set results: accuracy= 0.5728
Epoch 750 Train set results: loss= 1.8529 accuracy= 0.5545
Epoch 750 Validation set results: accuracy= 0.5482
Epoch 750 Test set results: accuracy= 0.5492
Epoch 800 Train set results: loss= 1.8484 accuracy= 0.5567
Epoch 800 Validation set results: accuracy= 0.5479
Epoch 800 Test set results: accuracy= 0.5525
Epoch 850 Train set results: loss= 1.8005 accuracy= 0.5641
Epoch 850 Validation set results: accuracy= 0.5690
Epoch 850 Test set results: accuracy= 0.5722
Epoch 900 Train set results: loss= 1.8005 accuracy= 0.5598
Epoch 900 Validation set results: accuracy= 0.5633
Epoch 900 Test set results: accuracy= 0.5677
Epoch 950 Train set results: loss= 1.8715 accuracy= 0.5551
Epoch 950 Validation set results: accuracy= 0.5530
Epoch 950 Test set results: accuracy= 0.5588
Epoch 1000 Train set results: loss= 1.8121 accuracy= 0.5556
Epoch 1000 Validation set results: accuracy= 0.5607
Epoch 1000 Test set results: accuracy= 0.5648
Epoch 1050 Train set results: loss= 1.8338 accuracy= 0.5558
Epoch 1050 Validation set results: accuracy= 0.5668
Epoch 1050 Test set results: accuracy= 0.5743
Epoch 1100 Train set results: loss= 1.8573 accuracy= 0.5569
Epoch 1100 Validation set results: accuracy= 0.5599
Epoch 1100 Test set results: accuracy= 0.5671
Epoch 1150 Train set results: loss= 1.9061 accuracy= 0.5476
Epoch 1150 Validation set results: accuracy= 0.5551
Epoch 1150 Test set results: accuracy= 0.5586
Epoch 1200 Train set results: loss= 1.8222 accuracy= 0.5614
Epoch 1200 Validation set results: accuracy= 0.5625
Epoch 1200 Test set results: accuracy= 0.5650
Epoch 1250 Train set results: loss= 1.8213 accuracy= 0.5594
Epoch 1250 Validation set results: accuracy= 0.5641
Epoch 1250 Test set results: accuracy= 0.5655
Epoch 1300 Train set results: loss= 1.8209 accuracy= 0.5636
Epoch 1300 Validation set results: accuracy= 0.5771
Epoch 1300 Test set results: accuracy= 0.5861
Epoch 1350 Train set results: loss= 1.8793 accuracy= 0.5500
Epoch 1350 Validation set results: accuracy= 0.5551
Epoch 1350 Test set results: accuracy= 0.5671
Epoch 1400 Train set results: loss= 1.8620 accuracy= 0.5499
Epoch 1400 Validation set results: accuracy= 0.5627
Epoch 1400 Test set results: accuracy= 0.5642
Epoch 1450 Train set results: loss= 1.9070 accuracy= 0.5446
Epoch 1450 Validation set results: accuracy= 0.5504
Epoch 1450 Test set results: accuracy= 0.5545
Epoch 1500 Train set results: loss= 1.8586 accuracy= 0.5513
Epoch 1500 Validation set results: accuracy= 0.5552
Epoch 1500 Test set results: accuracy= 0.5626
Epoch 1550 Train set results: loss= 1.8434 accuracy= 0.5577
Epoch 1550 Validation set results: accuracy= 0.5677
Epoch 1550 Test set results: accuracy= 0.5798
Epoch 1600 Train set results: loss= 1.8232 accuracy= 0.5643
Epoch 1600 Validation set results: accuracy= 0.5771
Epoch 1600 Test set results: accuracy= 0.5844
Epoch 1650 Train set results: loss= 1.8443 accuracy= 0.5532
Epoch 1650 Validation set results: accuracy= 0.5567
Epoch 1650 Test set results: accuracy= 0.5629
Epoch 1700 Train set results: loss= 1.8177 accuracy= 0.5585
Epoch 1700 Validation set results: accuracy= 0.5758
Epoch 1700 Test set results: accuracy= 0.5840
Epoch 1750 Train set results: loss= 1.7873 accuracy= 0.5599
Epoch 1750 Validation set results: accuracy= 0.5728
Epoch 1750 Test set results: accuracy= 0.5747
Epoch 1800 Train set results: loss= 1.7946 accuracy= 0.5615
Epoch 1800 Validation set results: accuracy= 0.5717
Epoch 1800 Test set results: accuracy= 0.5805
Epoch 1850 Train set results: loss= 1.8272 accuracy= 0.5553
Epoch 1850 Validation set results: accuracy= 0.5742
Epoch 1850 Test set results: accuracy= 0.5807
Epoch 1900 Train set results: loss= 1.8640 accuracy= 0.5516
Epoch 1900 Validation set results: accuracy= 0.5668
Epoch 1900 Test set results: accuracy= 0.5722
Epoch 1950 Train set results: loss= 1.8368 accuracy= 0.5591
Epoch 1950 Validation set results: accuracy= 0.5699
Epoch 1950 Test set results: accuracy= 0.5707
Epoch 2000 Train set results: loss= 1.8103 accuracy= 0.5592
Epoch 2000 Validation set results: accuracy= 0.5718
Epoch 2000 Test set results: accuracy= 0.5831
小图训练用时: 1139 秒
Best Test Acc: tensor(0.5861, device='cuda:0', dtype=torch.float64)
